# ./server-CA.riscv &
[1] 122
# [S]  . Seeding the random number generator... ok

[S]  . Loading the server cert. and key... ok
[S]  . Bind on https://localhost:4433/ ... ok
[S]  . Setting up the SSL data.... ok
[S]  . Waiting for a remote connection ...
# ./enclave-Alice.ke 
Verifying archive integrity... All good.
Uncompressing Keystone Enclave Package
Ticks needed for the creation of the enclave: 4783866d
Setting calloc and free...
Setting exit...
Setting printf...
Setting fprintf...
Setting snprintf...
Setting vsnprintf...

[C] Getting TCI values...
TCI enclave: 0xbdf9a9523c995539797f41936a72bff2dfe33b9f3c9b69b877272576d65aacfc96a54e51c87a0e6b58d8fcb8c510752353b5001a029e222d6c84eb644188fcbd
TCI enclave_len: 64
TCI sm: 0x4174151ec0126c38f61db3f0f8f90eaba33239361fa210125a48a3fb031b2b7b9dc42dfd5681c14139208c3a3bced811612aa6bb343786556d5204c58044a719
TCI sm_len: 64

[C] Generating LDevID...

LDevID PK: 0xbe03605e2ae124f2db6526648d549aa1d2cf39c22789c1335b6e4952313ba2bf
LDevID PK_len: 32

[C]  . Loading the CA root certificate ... ok (0 skipped)
[C]  . Connecting to tcp/localhost/4433... ok
[S]  . Performing the SSL/TLS handshake... ok
[C]  . Setting up the SSL/TLS structure... ok
[C]  . Performing the SSL/TLS handshake... ok
[C]  . Verifying peer X.509 certificate... ok
[C]  > Write to server: ok
[S]  < Read from client:[C] 23 bytes written

GET /nonce HTTP/1.0

[C]  < Read from server: 23 bytes read

GET /nonce HTTP/1.0

[S]  > Write to client: 114 bytes read

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - nonce</h2>
<p>��ͽ�?�(/M��^,#���������o|�</p>
nonce: 0x95b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3
nonce_len: 32
[C] Generating CSR... 114 bytes written

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - nonce</h2>
<p>��ͽ�?�(/M��^,#���������o|�</p>

[S]  < Read from client:

Getting DICE certificates...
certs[0]: 0x308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321001c5e33a3bae48c41e689933ab4fb8fb8683ad8957be2430639b82ebf337f637fa35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff04404174151ec0126c38f61db3f0f8f90eaba33239361fa210125a48a3fb031b2b7b9dc42dfd5681c14139208c3a3bced811612aa6bb343786556d5204c58044a719300706032b657005000341003a5918c8843de4124f5b77e900f00f6839c3833ad10a7bee57a5b7fc3f65ab79bbd4bb081d1248d7a87bb36f0dfee0c04748d69e1f3599e991c1b59425edac0b
certs[0]_len: 332
certs[1]: 0x3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b307805000321005a4e09f526f55be39730fcac79d4aa208ae06343cd6a9d9555ca6fadb35b926ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100e5114143b1a89b1e18a69a7ff96ed931c6fa28006711b6501cd47781dcf7484ce9e4a0b2abe7cc325a100f285de9b104b91ed3fbcb3ee47e39abe1110d67d007
certs[1]_len: 254
certs[2]: 0x3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06
certs[2]_len: 254

Generating attestation proof...
attest_proof: 0x8e97184eb6ebc67b41e28dc3f1cec4ea85e76762ab147317a82484035ba695432cb51b41937acac7be726786250d2c0a26cbb2595efe1ac1b69f0eaa2c492607
attest_proof_len: 64

Setting md algorithm
Setting key usage - ret: 0
Setting subject - ret: 0
Setting pk - ret: 0
Setting pk context
Setting nonce - ret: 0
Setting attestation proof - ret: 0
Setting chain of certs - ret: 0

Writing CSR - ret: 1197
CSR: 0x308204a9308204590201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b30780500032100be03605e2ae124f2db6526648d549aa1d2cf39c22789c1335b6e4952313ba2bfa08203ff308203fb06092a864886f70d01090e318203ec308203e8300b0603551d0f0404030203b8302a06032b6560042303210095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304a06032b656204430341008e97184eb6ebc67b41e28dc3f1cec4ea85e76762ab147317a82484035ba695432cb51b41937acac7be726786250d2c0a26cbb2595efe1ac1b69f0eaa2c4926073082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321001c5e33a3bae48c41e689933ab4fb8fb8683ad8957be2430639b82ebf337f637fa35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff04404174151ec0126c38f61db3f0f8f90eaba33239361fa210125a48a3fb031b2b7b9dc42dfd5681c14139208c3a3bced811612aa6bb343786556d5204c58044a719300706032b657005000341003a5918c8843de4124f5b77e900f00f6839c3833ad10a7bee57a5b7fc3f65ab79bbd4bb081d1248d7a87bb36f0dfee0c04748d69e1f3599e991c1b59425edac0b0481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b307805000321005a4e09f526f55be39730fcac79d4aa208ae06343cd6a9d9555ca6fadb35b926ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100e5114143b1a89b1e18a69a7ff96ed931c6fa28006711b6501cd47781dcf7484ce9e4a0b2abe7cc325a100f285de9b104b91ed3fbcb3ee47e39abe1110d67d0070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b6570050003410099627ce248169c366d353e4e002ad15f153a0ede875908aa1ce3d968cc5137c0a96ba28e6ff648690f466b1ef25c4a27b74cd05867865dd3c711a21421399509
CSR_len: 1197

[C]  > Write to server: 98 bytes read

POST /csr/size HTTP/1.0
Content-Type: text/html

<h2>Client Alice - csr len</h2>
<p>1197</p>
[C] 98 bytes written

POST /csr/size HTTP/1.0
Content-Type: text/html

<h2>Client Alice - csr len</h2>
<p>1197</p>
[C]  > Write to server:[C] 1283 bytes written

[S] csr_len=1197
[S]  < Read from client:POST /csr HTTP/1.0
Content-Type: text/html

<h2>Client Alice - csr</h2>
<p>0��0�Y 1283 bytes read

POST /csr HTTP/1.0
Content-Type: text/html

<h2>Client Alice - csr</h2>
<p>0��0�Y[S] csr: 0x308204a9308204590201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b30780500032100be03605e2ae124f2db6526648d549aa1d2cf39c22789c1335b6e4952313ba2bfa08203ff308203fb06092a864886f70d01090e318203ec308203e8300b0603551d0f0404030203b8302a06032b6560042303210095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304a06032b656204430341008e97184eb6ebc67b41e28dc3f1cec4ea85e76762ab147317a82484035ba695432cb51b41937acac7be726786250d2c0a26cbb2595efe1ac1b69f0eaa2c4926073082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321001c5e33a3bae48c41e689933ab4fb8fb8683ad8957be2430639b82ebf337f637fa35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff04404174151ec0126c38f61db3f0f8f90eaba33239361fa210125a48a3fb031b2b7b9dc42dfd5681c14139208c3a3bced811612aa6bb343786556d5204c58044a719300706032b657005000341003a5918c8843de4124f5b77e900f00f6839c3833ad10a7bee57a5b7fc3f65ab79bbd4bb081d1248d7a87bb36f0dfee0c04748d69e1f3599e991c1b59425edac0b0481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b307805000321005a4e09f526f55be39730fcac79d4aa208ae06343cd6a9d9555ca6fadb35b926ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100e5114143b1a89b1e18a69a7ff96ed931c6fa28006711b6501cd47781dcf7484ce9e4a0b2abe7cc325a100f285de9b104b91ed3fbcb3ee47e39abe1110d67d0070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b6570050003410099627ce248169c366d353e4e002ad15f153a0ede875908aa1ce3d968cc5137c0a96ba28e6ff648690f466b1ef25c4a27b74cd05867865dd3c711a21421399509
[S] csr_len: 1197
[S] Parsing CSR...

Parsing CSR - ret: 0

[S] Verifying CSR...

Hashing CSR- ret: 0
Verify CSR signature - ret: 0

Verify nonce len - ret: 0
Verify nonce value - ret: 0

Parsing Trusted Certificate - ret: 0
Verifing Chain of Certificates - ret: 0, flags = 0

Getting SM PK - ret: 0
Getting Reference Enclave TCI - ret: 0
Parsing SM PK - ret: 0
Verifying attestation proof - ret: 0

[S] Generating Certificate...

Setting issuer - ret: 0
Setting subject - ret: 0
Parsing issuer pk - ret: 0
Parsing issuer sk - ret: 0
Parsing subject pk - ret: 0
Setting subject key
Setting issuer keys
Setting serial - ret: 0
Setting md algorithm
Setting validity - ret: 0
Setting tci - ret: 0

Writing Enclave Certificate - ret: 345
Enclave Certificate: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b30780500032100be03605e2ae124f2db6526648d549aa1d2cf39c22789c1335b6e4952313ba2bfa34b304930470603ff20ff0440bdf9a9523c995539797f41936a72bff2dfe33b9f3c9b69b877272576d65aacfc96a54e51c87a0e6b58d8fcb8c510752353b5001a029e222d6c84eb644188fcbd300706032b6570050003410010e01a038187add50efa0db7b2f69780390ff3e5b39a05633c8e46285c169f640b345bf8d8002f891904c184846688d1184d38956837817f3d98430f3709f203
Enclave Certificate_len: 345
[S]  > Write to client: 86 bytes read

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - crt len</h2>
<p>345</p>
[C] cert_len: 345
 86 bytes written

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - crt len</h2>
<p>345</p>

[S]  > Write to client: 425 bytes read

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - crt</h2>
<p>0�U0��certificate: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303 425 bytes written

HTTP/1.0 200 OK
Content-Type: text/html

<h2>CA Server - crt</h2>
<p>0�U0��
[S]  . Closing the connection... ok
130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b30780500032100be03605e2ae124f2db6526648d549aa1d2cf39c227[S]  . Waiting for a remote connection ...89c1335b6e4952313ba2bfa34b304930470603ff20ff0440bdf9a9523c995539797f41936a72bff2dfe33b9f3c9b69b877272576d65aacfc96a54e51c87a0e6b58d8fcb8c510752353b5001a029e222d6c84eb644188fcbd300706032b6570050003410010e01a038187add50efa0db7b2f69780390ff3e5b39a05633c8e46285c169f640b345bf8d8002f891904c184846688d1184d38956837817f3d98430f3709f203
certificate_len: 345
Parsing Enclave Certificate - ret: 0

Connected using TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256