Welcome to Buildroot
buildroot login: root
Password: 
# insmod keystone-driver.ko 
[  360.385138] keystone_driver: loading out-of-tree module taints kernel.
[  360.390065] keystone_enclave: keystone enclave v1.0.0
# ./enclave-Alice.ke 
Verifying archive integrity... All good.
Uncompressing Keystone Enclave Package
Ticks needed for the creation of the enclave: 3422292d
Setting calloc and free...
Setting exit...
Setting printf...
Setting fprintf...
Setting snprintf...
Setting vsnprintf...
Setting crypto_interface...

[C] Getting TCI values...
TCI enclave: 0xbba5212d2ee0024ed070568766f0058f793447badf8b4a6d1e93c3f1c7b4c56fad70614d16f26206f8b5d9b401782d4e9223af07c748f9df0975434c124a38f7
TCI enclave_len: 64
TCI sm: 0xb013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
TCI sm_len: 64

Retrieving cert from memory...
Error in retrieving crt
[C] Generating LDevID...

LDevID PK: 0x5058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05f
LDevID PK_len: 32

[C]  . Loading the CA root certificate ... ok (0 skipped)
[C]  . Connecting to tcp/localhost/4433... failed
[C]  ! mbedtls_net_connect returned -68

[C] Last error was: -68 - UNKNOWN ERROR CODE (0044)

Storing the certificate in memory...
# ./server-CA.riscv &
[1] 190
# [S]  . Seeding the random number generator... ok

[S]  . Loading the server cert. and key... ok
[S]  . Bind on https://localhost:4433/ ... ok
[S]  . Setting up the SSL data.... ok
[S]  . Waiting for a remote connection ...
# ./enclave-Alice.ke 
Verifying archive integrity... All good.
Uncompressing Keystone Enclave Package
Ticks needed for the creation of the enclave: 3210254d
Setting calloc and free...
Setting exit...
Setting printf...
Setting fprintf...
Setting snprintf...
Setting vsnprintf...
Setting crypto_interface...

[C] Getting TCI values...
TCI enclave: 0xbba5212d2ee0024ed070568766f0058f793447badf8b4a6d1e93c3f1c7b4c56fad70614d16f26206f8b5d9b401782d4e9223af07c748f9df0975434c124a38f7
TCI enclave_len: 64
TCI sm: 0xb013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
TCI sm_len: 64

Retrieving cert from memory...
Stored crt: 0x
Stored crt_len: 0
[C] Generating LDevID...

LDevID PK: 0x5058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05f
LDevID PK_len: 32

[C]  . Loading the CA root certificate ... ok (0 skipped)
[C]  . Connecting to tcp/localhost/4433... ok
[S]  . Performing the SSL/TLS handshake... ok
[C]  . Setting up the SSL/TLS structure... ok
[C]  . Performing the SSL/TLS handshake... ok
[C]  . Verifying peer X.509 certificate... ok
[C]  > Write to server:[C] 1073741744 bytes written

GET /nonce HTTP/1.0

[C]  < Read from server: ok
[S]  < Read from client: 23 bytes read

GET /nonce HTTP/1.0

[S]  > Write to client: 101 bytes read

HTTP/1.0 200 OK
Content-Type: application/json

{"nonce": "0x��ͽ�?�(/M��^,#���������o|�"}
nonce: 0x95b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3
nonce_len: 32
[C] Generating CSR...

Getting DICE certificates...
certs[0]: 0x308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f662054727573 101 bytes written

HTTP/1.0 200 OK
Content-Type: application/json

{"nonce": "0x��ͽ�?�(/M��^,#���������o|�"}

[S]  < Read from client:74301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd03
certs[0]_len: 332
certs[1]: 0x3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba9507
certs[1]_len: 254
certs[2]: 0x3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06
certs[2]_len: 254

Generating attestation proof...
attest_proof: 0xf464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b009
attest_proof_len: 64

Setting md algorithm
Setting key usage - ret: 0
Setting subject - ret: 0
Setting pk - ret: 0
Setting pk context
Setting nonce - ret: 0
Setting attestation proof - ret: 0
Setting chain of certs - ret: 0

Writing CSR - ret: 1195
CSR: 0x308204a7308204570201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa08203fd308203f906092a864886f70d01090e318203ea308203e6300b0603551d0f040403020780302906032b65600422042095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304906032b656204420440f464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b0093082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd030481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba95070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b65700500034100dfd9dfae056d6dd6e4c8a9a4ac4a1e5b935948dd7b78c5564d8eef6262358c309523d5a2af8293bd22bd0c5cf7727cfc63612ca51bcfca991d3394e89ec9c302
CSR_len: 1195

[C]  > Write to server: 1286 bytes read

POST /csr/size HTTP/1.0
Content-Type: application/json

{"csr_len": 1195, "csr": "00��0�W[S] csr_len=1195
[C] 1286 bytes written

POST /csr/size HTTP/1.0
Content-Type: application/json

{"csr_len": 1195, "csr": "00��0�W[S] csr: 0x308204a7308204570201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa08203fd308203f906092a864886f70d01090e318203ea308203e6300b0603551d0f040403020780302906032b65600422042095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304906032b656204420440f464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b0093082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd030481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba95070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b65700500034100dfd9dfae056d6dd6e4c8a9a4ac4a1e5b935948dd7b78c5564d8eef6262358c309523d5a2af8293bd22bd0c5cf7727cfc63612ca51bcfca991d3394e89ec9c302
[S] csr_len: 1195
[S] Parsing CSR...

Parsing CSR - ret: 0

[S] Verifying CSR...

Hashing CSR- ret: 0
Verify CSR signature - ret: 0

Verify nonce len - ret: 0
Verify nonce value - ret: 0

Parsing Trusted Certificate - ret: 0
Verifing Chain of Certificates - ret: 0, flags = 0

Getting SM PK - ret: 0
Getting Reference Enclave TCI - ret: 0
Parsing SM PK - ret: 0
Verifying attestation proof - ret: 1

[S] Generating Certificate...

Setting issuer - ret: 0
Setting subject - ret: 0
Parsing issuer pk - ret: 0
Parsing issuer sk - ret: 0
Parsing subject pk - ret: 0
Setting subject key
Setting issuer keys
Setting serial - ret: 0
Setting md algorithm
Setting validity - ret: 0
Setting tci - ret: 0

Writing Enclave Certificate - ret: 345
Enclave Certificate: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa34b304930470603ff20ff0440ec0a437511ef9af8d9064e17fae01e211073a20101ba3e49546c884c4b127b543c5196acf0a8d8c4e24ec6f540582ea9c6535482c326c5fc51051a7da0b372ed300706032b657005000341005ec3d50d83c94b0724406dc53aa7c70a6c4c98e06280b851766373b64195fda2119f246c4d8f95ec2a1d49489e97299d64a48a15bb5aae7c1e77237fd7ecaa01
Enclave Certificate_len: 345
[S]  > Write to client: 428 bytes read

HTTP/1.0 200 OK
Content-Type: application/json

{"crt_len": 345, "crt": "0x0�U0��[C] cert_len: 345
Parsing Enclave Certificate - ret: 0

Connected using TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256
 428 bytes written

HTTP/1.0 200 OK
Content-Type: application/json

{"crt_len": 345, "crt": "0x0�U0��
[S]  . Closing the connection... ok
[S]  . Waiting for a remote connection ...Storing the certificate in memory...
# ./enclave-Alice.ke 
Verifying archive integrity... All good.
Uncompressing Keystone Enclave Package
Ticks needed for the creation of the enclave: 3275717d
Setting calloc and free...
Setting exit...
Setting printf...
Setting fprintf...
Setting snprintf...
Setting vsnprintf...
Setting crypto_interface...

[C] Getting TCI values...
TCI enclave: 0xbba5212d2ee0024ed070568766f0058f793447badf8b4a6d1e93c3f1c7b4c56fad70614d16f26206f8b5d9b401782d4e9223af07c748f9df0975434c124a38f7
TCI enclave_len: 64
TCI sm: 0xb013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
TCI sm_len: 64

Retrieving cert from memory...
Stored crt: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa34b304930470603ff20ff0440ec0a437511ef9af8d9064e17fae01e211073a20101ba3e49546c884c4b127b543c5196acf0a8d8c4e24ec6f540582ea9c6535482c326c5fc51051a7da0b372ed300706032b657005000341005ec3d50d83c94b0724406dc53aa7c70a6c4c98e06280b851766373b64195fda2119f246c4d8f95ec2a1d49489e97299d64a48a15bb5aae7c1e77237fd7ecaa01
Stored crt_len: 345
[C] Generating LDevID...

LDevID PK: 0x5058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05f
LDevID PK_len: 32

[C]  . Loading the CA root certificate ... ok (0 skipped)
[C]  . Connecting to tcp/localhost/4433... ok
[S]  . Performing the SSL/TLS handshake... ok
[C]  . Setting up the SSL/TLS structure... ok
[C]  . Performing the SSL/TLS handshake... ok
[C]  . Verifying peer X.509 certificate... ok
[C]  > Write to server:[C] 1073741744 bytes written

GET /nonce HTTP/1.0

[C]  < Read from server: ok
[S]  < Read from client: 23 bytes read

GET /nonce HTTP/1.0

[S]  > Write to client: 101 bytes written

HTTP/1.0 200 OK
Content-Type: application/json

{"nonce": "0x��ͽ�?�(/M��^,#���������o|�"}

[S]  < Read from client: 101 bytes read

HTTP/1.0 200 OK
Content-Type: application/json

{"nonce": "0x��ͽ�?�(/M��^,#���������o|�"}
nonce: 0x95b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3
nonce_len: 32
[C] Generating CSR...

Getting DICE certificates...
certs[0]: 0x308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd03
certs[0]_len: 332
certs[1]: 0x3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba9507
certs[1]_len: 254
certs[2]: 0x3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06
certs[2]_len: 254

Generating attestation proof...
attest_proof: 0xf464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b009
attest_proof_len: 64

Setting md algorithm
Setting key usage - ret: 0
Setting subject - ret: 0
Setting pk - ret: 0
Setting pk context
Setting nonce - ret: 0
Setting attestation proof - ret: 0
Setting chain of certs - ret: 0

Writing CSR - ret: 1195
CSR: 0x308204a7308204570201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa08203fd308203f906092a864886f70d01090e318203ea308203e6300b0603551d0f040403020780302906032b65600422042095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304906032b656204420440f464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b0093082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd030481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba95070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4ca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b65700500034100dfd9dfae056d6dd6e4c8a9a4ac4a1e5b935948dd7b78c5564d8eef6262358c309523d5a2af8293bd22bd0c5cf7727cfc63612ca51bcfca991d3394e89ec9c302
CSR_len: 1195

[C]  > Write to server: 1286 bytes read

POST /csr/size HTTP/1.0
Content-Type: application/json

{"csr_len": 1195, "csr": "00��0�W[S] csr_len=1195
[S] csr: 0x308204a7308204570201003023310f300d06035504030c06436c69656e743110300e060355040a0c07456e636c617665302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa08203fd308203f906092a864886f70d01090e318203ea308203e6300b0603551d0f040403020780302906032b65600422042095b2cdbd9c3fe928162f4d86c65e2c230faad4ff01178583baa588966f7c1ff3304906032b656204420440f464aa1627cee1c3d5d6617786cf8d22633ed551b3f91c078b0b1c228ba950de001364f815e65920ac4a66533aebdf3d030b9a9d029e5331c969bfbb4711b0093082035f06032b656104820356308203520482014c308201483081f9a0030201020203000001300706032b65700500301831163014060355040a0c0d526f6f74206f66205472757374301e170d3233303130313030303030305a170d3234303130313030303030305a301b31193017060355040a0c105365637572697479204d6f6e69746f72302c300706037b307805000321007cce1d1f0afd10aefa131ac10c967ccf7730f1ab114dc98da97033ea2ace5ef7a35f305d30120603551d130101ff040830060101ff02010a30470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b6570050003410063ec3039a89503bba9e875426844de61ae70a0edcddf450600997da1d7a8a3a779158a5282a21721a0bd536d992bf1e3c3330c52cf8611778eed02652f18bd030481fe3081fb3081aca0030201020203000000300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301831163014060355040a0c0d526f6f74206f66205472757374302c300706037b30780500032100f3134976df8ab83e9d1eb14aa92679ee0924093e2edcf67d9f2227b26469328aa316301430120603551d130101ff040830060101ff02010a300706032b657005000341005ff756beea0e14877f4a5d4e17c97d6a3ffac4997f42d01b27f4d34b9e0eee63de65ac5e542e0fdd73a04426e1e31f3cae821a43006529c7912bab45e3ba95070481fe3081fb3081aca003020102020400ffffff300706032b65700500301731153013060355040a0c0c4d616e756661637475726572301e170d3233303130313030303030305a170d3234303130313030303030305a301731153013060355040a0c0c4d616e756661637475726572302c300706037b307805000321000faad4ff01178583baa588966f7c1ff32564dd17d7dc2b46cb50a84a69270b4[C] 1286 bytes written

POST /csr/size HTTP/1.0
Content-Type: application/json

{"csr_len": 1195, "csr": "00��0�Wca316301430120603551d130101ff040830060101ff02010a300706032b65700500034100b1efe8eb43d92e9f0500cb63c333800f8a1e6c7b134c6410fbc648e4009bc4f3df12ab6979195fb60230403813a04259e25a3e138e9da11042930f58cd07fc06300706032b65700500034100dfd9dfae056d6dd6e4c8a9a4ac4a1e5b935948dd7b78c5564d8eef6262358c309523d5a2af8293bd22bd0c5cf7727cfc63612ca51bcfca991d3394e89ec9c302
[S] csr_len: 1195
[S] Parsing CSR...

Parsing CSR - ret: 0

[S] Verifying CSR...

Hashing CSR- ret: 0
Verify CSR signature - ret: 0

Verify nonce len - ret: 0
Verify nonce value - ret: 0

Parsing Trusted Certificate - ret: 0
Verifing Chain of Certificates - ret: 0, flags = 0

Getting SM PK - ret: 0
Getting Reference Enclave TCI - ret: 0
Parsing SM PK - ret: 0
Verifying attestation proof - ret: 1

[S] Generating Certificate...

Setting issuer - ret: 0
Setting subject - ret: 0
Parsing issuer pk - ret: 0
Parsing issuer sk - ret: 0
Parsing subject pk - ret: 0
Setting subject key
Setting issuer keys
Setting serial - ret: 0
Setting md algorithm
Setting validity - ret: 0
Setting tci - ret: 0

Writing Enclave Certificate - ret: 345
Enclave Certificate: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b307805000321005058d4422807573fb3e3d491886bc686044386f95ff796b095e8f046e090b05fa34b304930470603ff20ff0440ec0a437511ef9af8d9064e17fae01e211073a20101ba3e49546c884c4b127b543c5196acf0a8d8c4e24ec6f540582ea9c6535482c326c5fc51051a7da0b372ed300706032b657005000341005ec3d50d83c94b0724406dc53aa7c70a6c4c98e06280b851766373b64195fda2119f246c4d8f95ec2a1d49489e97299d64a48a15bb5aae7c1e77237fd7ecaa01
Enclave Certificate_len: 345
[S]  > Write to client: 428 bytes read

HTTP/1.0 200 OK
Content-Type: application/json

{"crt_len": 345, "crt": "0x0�U0��[C] cert_len: 345
Parsing Enclave Certificate - ret: 0

Connected using TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256
Storing the certificate in memory...
 428 bytes written

HTTP/1.0 200 OK
Content-Type: application/json

{"crt_len": 345, "crt": "0x0�U0��
[S]  . Closing the connection... ok
[S]  . Waiting for a remote connection ...# poweroff