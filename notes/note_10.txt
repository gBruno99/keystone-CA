0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b30780500032100519a9e06ccb22f3628c77a732598768271448ca1b386123f44c16c1eb2b05720a34b304930470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b657005000341007e3dc907fc8bd6bf0efaee5f1bf49e774de68b3c7080da0ad44a862fe05b7795706d628c8ec43ff0089a195e2cf5d35b82a3dcb781d1914f145eb32a18fcf803

Enclave Certificate:
raw_tag: 00
raw: 0x3082015530820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b30780500032100519a9e06ccb22f3628c77a732598768271448ca1b386123f44c16c1eb2b05720a34b304930470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157300706032b657005000341007e3dc907fc8bd6bf0efaee5f1bf49e774de68b3c7080da0ad44a862fe05b7795706d628c8ec43ff0089a195e2cf5d35b82a3dcb781d1914f145eb32a18fcf803
raw_len: 345
tbs_tag: 00
tbs: 0x30820105a003020102020400ababab300706032b657005003020311e301c060355040a0c15436572746966696361746520417574686f72697479301e170d3233303130313030303030305a170d3234303130313030303030305a30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479302c300706037b30780500032100519a9e06ccb22f3628c77a732598768271448ca1b386123f44c16c1eb2b05720a34b304930470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
tbs_len: 265

version: 3
serial_tag: 02
serial: 0x00ababab
serial_len: 4
sig_oid_tag: 06
sig_oid: 0x2b6570
sig_oid_len: 3

issuer_raw_tag: 00
issuer_raw: 0x3020311e301c060355040a0c15436572746966696361746520417574686f72697479
issuer_raw_len: 34
subject_raw_tag: 00
subject_raw: 0x30323110300e06035504030c07436c69656e7431311e301c060355040a0c15436572746966696361746520417574686f72697479
subject_raw_len: 52

issuer_oid_tag: 06
issuer_oid: 0x55040a
issuer_oid_len: 3
issuer_tag: 0c
issuer: 0x436572746966696361746520417574686f72697479
issuer_len: 21
issuer_next: 0000000000000000
subject_oid_tag: 06
subject_oid: 0x550403
subject_oid_len: 3
subject_tag: 0c
subject: 0x436c69656e7431
subject_len: 7
subject_next: 0000000000024170

valid_from:
- year=2023, mon=1, day=1
- hour=0, min=0, sec=0
valid_to:
- year=2024, mon=1, day=1
- hour=0, min=0, sec=0

pk_raw_tag: 00
pk_raw: 0x302c300706037b30780500032100519a9e06ccb22f3628c77a732598768271448ca1b386123f44c16c1eb2b05720
pk_raw_len: 46
pk: ED25519
pk - pk: 0x519a9e06ccb22f3628c77a732598768271448ca1b386123f44c16c1eb2b05720
pk - pk_len: 32

issuer_id_tag: a3
issuer_id: 0x
issuer_id_len: 0
subject_id_tag: a3
subject_id: 0x
subject_id_len: 0
v3_ext_tag: a3
v3_ext: 0x304930470603ff20ff0440b013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
v3_ext_len: 75

0xb013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157

hash_tag: 00
hash: 0xb013d175c8ce7f98da643c3af944402ad1792a3aec29231e0d40d5c86d04e61d0ac182ca2fc619dba2e94a9b7d32102d6ef31f3aeca5cbdd5a1bede02be3b157
hash_len: 64

ca_istrue: 0
max_pathlen: 0

sig_tag: 03
sig: 0x7e3dc907fc8bd6bf0efaee5f1bf49e774de68b3c7080da0ad44a862fe05b7795706d628c8ec43ff0089a195e2cf5d35b82a3dcb781d1914f145eb32a18fcf803
sig_len: 64
sig_md: 8
sig_pk: 8

mbedtls_net_init
mbedtls_net_connect
mbedtls_net_bind
mbedtls_net_accept
mbedtls_net_free

mbedtls_ssl_init
mbedtls_ssl_config_init
mbedtls_ssl_config_defaults
mbedtls_ssl_conf_authmode
mbedtls_ssl_conf_ca_chain
mbedtls_ssl_conf_own_cert
mbedtls_ssl_conf_rng
mbedtls_ssl_conf_dbg
mbedtls_ssl_setup
mbedtls_ssl_session_reset
mbedtls_ssl_set_hostname
mbedtls_ssl_set_bio
mbedtls_ssl_handshake
mbedtls_ssl_get_verify_result
mbedtls_ssl_write
mbedtls_ssl_read
mbedtls_ssl_close_notify
mbedtls_ssl_free
mbedtls_ssl_config_free

mbedtls_x509_crt_init
mbedtls_x509_crt_parse
mbedtls_x509_crt_free

mbedtls_pk_init
mbedtls_pk_parse_key
mbedtls_pk_free

mbedtls_ctr_drbg_seed
mbedtls_ctr_drbg_init
mbedtls_ctr_drbg_free
mbedtls_entropy_init
mbedtls_entropy_free




# ./tls-server.riscv &
[1] 122
# 
[S]  . Seeding the random number generator... ok

[S]  . Loading the server cert. and key... ok
[S]  . Bind on https://localhost:4433/ ... ok
[S]  . Setting up the SSL data.... ok
[S]  . Waiting for a remote connection ...
# ./tls-client-enclave.ke 
Verifying archive integrity... All good.
Uncompressing Keystone Enclave Package
Ticks needed for the creation of the enclave: 5639157d

[C]  . Seeding the random number generator... ok
[C]  . Loading the CA root certificate ... ok (0 skipped)
[C]  . Connecting to tcp/localhost/4433... ok
[S]  . Performing the SSL/TLS handshake... ok
[C]  . Setting up the SSL/TLS structure... ok
[C]  . Performing the SSL/TLS handshake...
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(001d)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(0017)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(0018)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(001e)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(0019)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(001a)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(001b)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_client.c:0258: got supported group(001c)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_tls.c:7367: x509_verify_cert() returned -9984 (-0x2700)
 ok
[C]  . Verifying peer X.509 certificate... failed
  ! The certificate validity starts in the future

[C]  > Write to server:
[C] 18 bytes written

GET / HTTP/1.0

[C]  < Read from server: 
ok
[S]  < Read from client: 18 bytes read

GET / HTTP/1.0

[S]  > Write to client: 156 bytes written

HTTP/1.0 200 OK
Content-Type: text/html

<h2>mbed TLS Test Server</h2>
<p>Successful connection using: TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256</p>

[S]  . Closing the connection... ok
 156 bytes read

HTTP/1.0 200 OK
Content-Type: text/html

<h2>mbed TLS Test Server</h2>
<p>Successful connection using: TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256</p>
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_msg.c:3942: mbedtls_ssl_handle_message_type() returned -30848 (-0x7880)
/home/giacomo/Documents/keystone-CA/mbedtls_builds/mbedtls_host/library/ssl_msg.c:5501: mbedtls_ssl_read_record() returned -30848 (-0x7880)
[S]  . Waiting for a remote connection ...
# poweroff

